# 数据库	

## 第五章 关系规范化理论——关系数据库设计理论基础

重点：

* 关系模式存在的异常及其原因
* 函数依赖
* 1NF~3NF的定义
* 规范化的含义和作用
* 模式分解

难点

* 函数依赖

* 各级范式的含义和作用

* 数据依赖公理系统

---

### 数据冗余与操作异常问题

- 一个关系数据库中的关系都应满足一定的规范，才能构造出好的关系模式。

关系模式由五部分组成：R(U,D,DOM,F) 。

![关系五元组](E:\CodeBase\笔记\数据库\image\关系五元组.png)

数据冗余： 指同一数据在一个或多个数据文件中重复存储。

问题：

1. 占用大量系统存储资源，造成不必要的开销
2. 增加了插入、删除和更新数据的时间
3. 会带来数据库操作的异常

数据依赖： 是关系内部属性与属性之间的一种约束关系，是语义的体现。

类型:函数依赖(Functional Dependency,FD)和多值依赖(Multivalued Dependency,MVD)

关系规范化理论： 一套以对数据依赖的研究为基础，对关系数据库模式设计提出规范等级的理论与方法。通过分解关系模式来消除不合适的数据依赖，以此解决插入异常、删除异常、更新异常等异常。

### 函数依赖

- 平凡函数依赖
- 非平凡函数依赖
- 完全函数依赖 
- 部分函数依赖
- 传递函数依赖

数据冗余产生的主要原因：

* 部分函数依赖存在冗余属性
* 传递依赖反映出属性间的间接依赖，是一种弱数据依赖
* 存在部分依赖、传递依赖，是关系数据库产生数据冗余的主要原因。

### 范式

* 将属性间的数据依赖关系满足给定约束条件的关系模式称为范式，即范式是对关系的不同数据依赖程度的要求。

范式分类：第一范式 ~ 第三范式(1NF ~ 3NF),BCNF范式、第四范式，第五范式。

![范式等级](image\范式等级.png)

包含在任何一个候选码中的属性，称为主属性。不包含在任何码中的属性称为非主属性or非码属性。

最简单：单个属性是码。

最极端：整个属性组是码，也称全码(ALL-KEY)

基于函数依赖的范式有 1NF,2NF,,3NF和BCNF。

某一关系模式R为第n范式，记为：
$$
R∈nNF
$$
**第一范式**

如果关系模式R<U,F>中的每一个属性都是不可再分的，那么该关系模式属于第一范式(1NF),记为R∈1NF。

* 第一范式要求关系模式的每个属性是原子的。
* 第一范式是对关系模式最起码的要求，不满足第一范式的数据库模式不能称为关系数据库。
* 引起1NF的问题及解决方法：非主属性部分函数依赖于码。
  * 解决方法：分出关系模式。

**第二范式**

对于关系模式R<U,F>，若R∈1NF，且每一个非主属性完全函数依赖于码，则R是第二范式的，记为R∈2NF。

* 2NF要求非主属性不能部分依赖于码

  解决2NF存在问题的方法，采用投影分解法。

**第三范式**

不存在传递依赖。

若R∈3NF，则R的每一个非主属性既不部分函数依赖于候选码也不传递函数依赖于候选码。

可能存在问题：可能表现在主属性对码的部份依赖和传递依赖。

**BCNF范式**

关系模式R<U,F>中，每一个决定因素都包含码，则R<U,F>∈BCNF。

BCNF又称修正or扩充的第三范式。

**超码**

是属性集，候选码的集合。

| 2NF  |   去掉非主属性对候选码的部分函数依赖   |
| :--: | :------------------------------------: |
| 3NF  |   去掉非主属性对候选码的传递函数依赖   |
| BCNF | 去掉主属性对候选码的部分和传递函数依赖 |



### 数据依赖公理系统

将低级范式转化为高级范式的方法是对低级范式进行模式分解，模式分解算法的理论基础是数据依赖公理系统。

**Armstrong公理系统**是一套推理规则，是模式分解的算法理论基础。

用途：

* 从一组函数依赖求得蕴含的函数依赖。
* 求给定关系模式的码

三条推理规则：

![image-20210701170357435](E:\CodeBase\笔记\数据库\image\Armstrong推理规则)

函数闭包：

### 模式分解

三种模式分解等价定义：

* 分解具有无损连接性
* 分解要保持函数依赖
* 分解既要保持函数依赖，又要具有无损连接性
